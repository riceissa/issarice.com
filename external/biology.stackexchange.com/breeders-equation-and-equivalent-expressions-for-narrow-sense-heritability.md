I am trying to model the phenotype of a trait as $X = G + E$, where $G$ and $E$ are the genetic and environmental effects. (I'll ignore the distinction between broad-sense and narrow-sense heritability in this question.) [Wikipedia](https://en.wikipedia.org/wiki/Heritability#Definition) tells me that $$h^2 = \frac{\mathrm{Var}(G)}{\mathrm{Var}(X)}$$ The same page also gives the breeder's equation $R = h^2S$ but also says "Note that heritability in the [breeder's equation] is equal to the ratio [${\mathrm  {Var}}(G)/{\mathrm  {Var}}(X)$] only if the genotype and the environmental noise follow Gaussian distributions." So let $G \sim N(0, \sigma_G^2)$ and $E \sim N(0, \sigma_E^2)$ be distributed according to normal distributions. Then $X \sim N(0, \sigma_G^2 + \sigma_E^2)$ so $$h^2 = \frac{\mathrm{Var}(G)}{\mathrm{Var}(X)} = \frac{\sigma_G^2}{\sigma_G^2 + \sigma_E^2}$$

Now I want to perform a selection, choosing a parent with $X=a$. We can expect the child to have the trait $\mathbb E[G \mid X=a] + E'$ where $E' \sim N(0, \sigma_E^2)$ is some other environmental effect. (I don't want to bother with recombination and multiple parents, so we can just think of it as cloning the parent: given that $X=a$, we expect the parent's genetic part to have been $\mathbb E[G \mid X=a]$.)

To find $\mathbb E[G \mid X=a]$, note that $\mathbb E[X \mid X=a] = a$ and by linearity of expectation, $\mathbb E[X \mid X=a] = \mathbb E[G \mid X=a] + \mathbb E[E \mid X=a]$. To get the terms to cancel, we want to write $E$ as $\alpha E$ where $\alpha E$ has the same distribution as $G$. Since $\alpha E \sim N(0, \alpha^2 \sigma_E^2)$, we want $\alpha^2 \sigma_E^2 = \sigma_G^2$, so $\alpha = \sigma_G/\sigma_E$. Thus we have $$\begin{align}a &= \mathbb E[G \mid X=a] + \frac1\alpha\mathbb E[\alpha E \mid X=a] \\ &= \mathbb E[G \mid X=a] + \frac1\alpha\mathbb E[G \mid X=a] \\ &= \left(1+\frac1\alpha\right)\mathbb E[G \mid X=a]\end{align}$$ Hence $$\mathbb E[G \mid X=a] = \frac{a}{1+\frac1\alpha} = \frac{a}{1+\frac{\sigma_E}{\sigma_G}}$$

Since the parent was selected at $X=a$ and the child has mean $\frac{a}{1+\frac{\sigma_E}{\sigma_G}}$, we have $$h^2=\frac{R}{S} = \frac{1}{1+\frac{\sigma_E}{\sigma_G}} = \frac{\sigma_G}{\sigma_G+\sigma_E}$$

Now my problem is that the two expressions for $h^2$ don't match. They look pretty similar, but one of them has all the terms squared while the other one doesn't. What's going on/where did I go wrong?
